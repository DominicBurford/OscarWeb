function loadDocumentManagerForDocument(n){onDocumentViewInit();n&&(onDocumentViewNode(n),$.ajax({type:"GET",url:`/DocumentManager/DocumentManager?handler=document&id=${n.id}`,contentType:"application/json",dataType:"json",success:function(n){onDocumentViewSuccess(n)},failure:function(n){onDocumentViewFailure(n)}}))}function onSelect_DocumentManagerItem(n){var t=$("#documentview").data("kendoTreeView").dataItem(n.node);onDocumentViewInit();t&&(onDocumentViewNode(t),$.ajax({type:"GET",url:`/DocumentManager/DocumentManager?handler=document&id=${t.id}`,contentType:"application/json",dataType:"json",success:function(n){onDocumentViewSuccess(n)},failure:function(n){onDocumentViewFailure(n)}}))}function onDocumentViewInit(){DisableToolbarButtons();$("#document_details_name")[0].innerHTML="";$("#document_details_id")[0].innerHTML="";$("#document_details_children")[0].innerHTML="";$("#document_details_description")[0].innerHTML="";$("#document_details_lastviewed")[0].innerHTML="";$("#document_details_uploadedby")[0].innerHTML="";$("#document_details_type")[0].innerHTML="";$("#document_details_category")[0].innerHTML="";$("#document_details_created")[0].innerHTML="";$("#document_details_ownersubscriber")[0].innerHTML=""}function onDocumentViewNode(n){$("#document_details_name")[0].innerHTML=n.text;$("#document_details_id")[0].innerHTML=n.id;$("#downloadpostDownload")[0].value=n.id;$("#vieweventspostView")[0].value=n.id;typeof $("#editpostEdit")[0]!="undefined"&&($("#editpostEdit")[0].value=n.id);typeof $("#deletepostDelete")[0]!="undefined"&&($("#deletepostDelete")[0].value=n.id);typeof $("#uploadpostUpload")[0]!="undefined"&&($("#uploadpostUpload")[0].value=n.id);typeof $("#createfolderpostCreate")[0]!="undefined"&&($("#createfolderpostCreate")[0].value=n.id)}function onDocumentViewSuccess(n){var i,r,u,t;$("#document_details_description")[0].innerHTML=n.Description;i=n.LastView;$("#document_details_lastviewed")[0].innerHTML=i;i!=="Never"&&($("#document_details_lastviewed")[0].innerHTML=withoutTime(n.LastView));$("#document_details_uploadedby")[0].innerHTML=n.UploadedByUsername;$("#document_details_type")[0].innerHTML=n.DocumentTypeDescription;$("#document_details_category")[0].innerHTML=n.DocumentCategoryDescription;$("#document_details_created")[0].innerHTML=withoutTime(n.Created);$("#document_details_ownersubscriber")[0].innerHTML=n.OwnerSubscriber;r=n.DocumentFolder;r==="Document"?($("#document_details_children")[0].innerHTML="Document",SetDocumentToolbar("Document")):r==="Folder"&&($("#document_details_children")[0].innerHTML="Folder",$("#document_details_lastviewed")[0].innerHTML="NA",SetDocumentToolbar("Folder"));SetToolbarButtons(n.OwnerSubscriber);u=$("#document_details_subscribers_view").data("kendoListBox");t=[];typeof n.Subscribers=="object"&&n.Subscribers.length>0?(t=new kendo.data.DataSource({data:n.Subscribers}),u.setDataSource(t)):(t=new kendo.data.DataSource({data:["None"]}),u.setDataSource(t))}function onDocumentViewFailure(n){console.log(`failure ${JSON.stringify(n)}`)}function ProfileDropdown(){$("#profiledropdown").css({top:"70px"});$("#profiledropdown").css({transition:"1s"});$("#profile_open_button").css({display:"none"});$("#profile_close_button").css({display:"inherit"})}function ProfileDropdown_Shut(){$("#profiledropdown").css({top:"-20%"});$("#profiledropdown").css({transition:"1s"});$("#profile_open_button").css({display:"inherit"});$("#profile_close_button").css({display:"none"})}function showdocumentlist(){$("#informationbox").css({display:"inline-block"})}function KeepSessionAlive(){$.ajax({type:"GET",url:"/Index?handler=session",contentType:"application/json",dataType:"json",success:function(){},failure:function(n){console.log(`failure ${JSON.stringify(n)}`)}})}function error_handler_kendo_grid(n){if(n.errors){var t="Errors:\n";$.each(n.errors,function(n,i){"errors"in i&&$.each(i.errors,function(){t+=this+"\n"})});console.log(t)}}function withoutTime(n){var t=new Date(n);return t.toDateString()}function SetDocumentToolbar(n){var t=document.getElementsByClassName("btn-default"),i,r;if(t&&t.length>0)if(n==="Folder")for(i=0;i<t.length;i++)t[i].classList.contains("Download")&&(t[i].disabled=!0),t[i].classList.contains("Upload")&&(t[i].disabled=!1),t[i].classList.contains("Create")&&(t[i].disabled=!1);else for(r=0;r<t.length;r++)t[r].classList.contains("Download")&&(t[r].disabled=!1),t[r].classList.contains("Upload")&&(t[r].disabled=!0),t[r].classList.contains("Create")&&(t[r].disabled=!0)}function DisableToolbarButtons(){var n=document.getElementsByClassName("btn-default"),t;if(n&&n.length>0)for(t=0;t<n.length;t++)n[t].classList.contains("Download")&&(n[t].disabled=!0),n[t].classList.contains("Edit")&&(n[t].disabled=!0),n[t].classList.contains("Delete")&&(n[t].disabled=!0),n[t].classList.contains("Upload")&&(n[t].disabled=!0),n[t].classList.contains("Create")&&(n[t].disabled=!0)}function SetToolbarButtons(n){if($("#document_details_children")[0].innerHTML==="Document"){var t=document.getElementsByClassName("btn-default");if(t&&t.length>0)if(n===DocumentSubscriber)for(let n=0;n<t.length;n++)t[n].classList.contains("Edit")&&(t[n].disabled=!0),t[n].classList.contains("Delete")&&(t[n].disabled=!0);else for(let n=0;n<t.length;n++)t[n].classList.contains("Edit")&&(t[n].disabled=!1),t[n].classList.contains("Delete")&&(t[n].disabled=!1)}}function onChange_UserGrid(){var t=this.select(),i=t[0].innerText.split("\t"),[r,u,n]=i;console.log(`selected [0] ${r} [1]${u} [2]${n}`);$.ajax({type:"GET",url:`/Administration/UserRoles/UserRolesAdmin?handler=selecteduser&useremail=${n}`,contentType:"application/json",dataType:"json",success:function(n){console.log(`success ${JSON.stringify(n)}`);UpdateUserRoleGrid(n)},failure:function(n){console.log(`error ${JSON.stringify(n)}`)}})}function onChange_UnreadDocuments(){var t=this.select(),i=t[0].innerText.split("\t"),[n,r,u,f]=i;console.log(`selected [0] ${n} [1] ${r} [2] ${u} [3] ${f}`);$("#unreaddocument_download")[0].value=n;$("#unreaddocument_details")[0].value=n;$("#submitDownload")[0].disabled=!1;$("#submitDetails")[0].disabled=!1}function UpdateUserRoleGrid(n){var u=$("#allroles").data("kendoListBox"),t,r,i;typeof n.AllRoles=="object"&&n.AllRoles.length>0?(t=new kendo.data.DataSource({data:n.AllRoles}),u.setDataSource(t)):(t=new kendo.data.DataSource({data:[]}),u.setDataSource(t));r=$("#selectedroles").data("kendoListBox");typeof n.UserRoles=="object"&&n.UserRoles.length>0?(i=new kendo.data.DataSource({data:n.UserRoles}),r.setDataSource(i)):(i=new kendo.data.DataSource({data:[]}),r.setDataSource(i))}function openProfileMenu(){document.getElementById("ProfileMenu").style.right="0px";document.getElementById("openProfileMenu").style.display="none";document.getElementById("closeProfileMenu").style.display="inherit"}function closeProfileMenu(){document.getElementById("ProfileMenu").style.right="-180px";document.getElementById("openProfileMenu").style.display="inherit";document.getElementById("closeProfileMenu").style.display="none"}function tree_drop(n){var t=$("#documentview").data("kendoTreeView"),i=$(n.sourceNode).data("uid"),r=$(n.destinationNode).data("uid"),u=t.dataSource.getByUid(i),f=t.dataSource.getByUid(r),e=`/DocumentManager/DocumentManager?handler=drop&sourceid=${u.id}&destinationid=${f.id}`;$.get(e)}function onRequestEnd_UnreadDocuments(n){console.log(`Data operation for onRequestEnd_UnreadDocuments ${n.type}`)}function submitDownload(){var n=$("#unreaddocument_download")[0].value;console.log(`Selected document ID for download ${n}`);$.ajax({type:"POST",beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},url:`/Index?handler=download&currentDocumentId=${n}`,contentType:"application/json",dataType:"json",success:function(){console.log(`success downloading document${n}`)},failure:function(t){console.log(`Failure downloading document${n}`);console.log(`Error response ${JSON.stringify(t)}`)}})}function refreshUnreadDocuments(){console.log("Refreshing unread documents");var n=$("#unreaddocumentsgrid").data("kendoGrid");n.dataSource.read()}function viewCompanyAddresses(n){var i=$(n.target).closest("tr"),r=$("#companygrid").data("kendoGrid"),t=r.dataItem(i);console.log(`Details for: ${t.Id} ${t.Name} ${t.StorageContainerName}`);window.open(`CompanyAddressAdmin?companyId=${t.Id}`,"_self")}const DocumentOwner="You are the owner of this document",DocumentSubscriber="You are a subscriber of this document";